module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/child_process [external] (child_process, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}),
"[externals]/fs [external] (fs, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}),
"[externals]/https [external] (https, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/os [external] (os, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}),
"[externals]/events [external] (events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}),
"[externals]/process [external] (process, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}),
"[externals]/util [external] (util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}),
"[externals]/path [external] (path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}),
"[externals]/crypto [external] (crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}),
"[externals]/querystring [external] (querystring, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}),
"[externals]/buffer [external] (buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}),
"[externals]/fs/promises [external] (fs/promises, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs/promises", () => require("fs/promises"));

module.exports = mod;
}),
"[externals]/node:stream [external] (node:stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}),
"[externals]/node:stream/promises [external] (node:stream/promises, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream/promises", () => require("node:stream/promises"));

module.exports = mod;
}),
"[externals]/http [external] (http, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}),
"[externals]/net [external] (net, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}),
"[externals]/tls [external] (tls, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}),
"[externals]/url [external] (url, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}),
"[externals]/zlib [external] (zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}),
"[project]/types.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ExamMode",
    ()=>ExamMode
]);
var ExamMode = /*#__PURE__*/ function(ExamMode) {
    ExamMode["XING_CE"] = "XING_CE";
    ExamMode["SHEN_LUN"] = "SHEN_LUN";
    ExamMode["MIAN_SHI"] = "MIAN_SHI"; // Interview
    return ExamMode;
}({});
}),
"[project]/constants.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "EXAM_TOPICS",
    ()=>EXAM_TOPICS,
    "MODEL_FLASH",
    ()=>MODEL_FLASH,
    "MODEL_PRO",
    ()=>MODEL_PRO,
    "MODE_DESCRIPTIONS",
    ()=>MODE_DESCRIPTIONS,
    "MODE_LABELS",
    ()=>MODE_LABELS,
    "SYSTEM_INSTRUCTIONS",
    ()=>SYSTEM_INSTRUCTIONS
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/types.ts [app-route] (ecmascript)");
;
const MODEL_FLASH = 'gemini-3-flash-preview';
const MODEL_PRO = 'gemini-3-pro-preview';
const EXAM_TOPICS = {
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].XING_CE]: [
        '随机混卷',
        '常识判断',
        '言语理解与表达',
        '数量关系',
        '判断推理',
        '资料分析'
    ],
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].SHEN_LUN]: [
        '随机练习',
        '归纳概括',
        '综合分析',
        '提出对策',
        '贯彻执行',
        '文章写作'
    ],
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].MIAN_SHI]: [
        '随机模拟',
        '综合分析',
        '人际关系',
        '应急应变',
        '组织管理',
        '情景模拟'
    ]
};
// System Instructions - prompt engineering is key here
const BASE_INSTRUCTION = `
你是一位中国公考（公务员、事业单位）顶级培训专家。
**核心指令**：
1. **直接作答**：利用你内置的海量真题库和知识储备直接回答用户问题。
2. **隐藏解析（重要）**：为了让用户先思考，**必须**将所有的**答案、详细解析、速算技巧、参考范文**包裹在 \`\`\`analysis ... \`\`\` 代码块中。**不要**在 \`analysis\` 块之外直接泄露答案。
   - 格式示例：
     问题内容...
     A. xxx
     B. xxx
     ...
     \`\`\`analysis
     【答案】B
     【解析】
     第一步：...
     第二步：...
     \`\`\`
3. **真题复现**：当用户询问真题时，凭记忆复现经典题目（包含题干、选项）。
4. **专业性**：严格依据中国国家公务员考试大纲。
5. **逻辑性**：结构清晰，分点作答。使用Markdown格式渲染重点。
`;
const SYSTEM_INSTRUCTIONS = {
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].XING_CE]: `
${BASE_INSTRUCTION}
【当前模式：行测 (Administrative Aptitude)】
- **角色**：逻辑思维导师、数学解题专家。
- **强制规范**：
  - **选项必填**：无论是用户要求出题、模拟题还是询问真题，**必须**在题干后列出 A、B、C、D 四个选项。
  - **图形推理特例**：对于图形推理题：
    1. **题干**：使用 SVG 代码绘制题目图形。
    2. **选项**：**必须**也使用 SVG 代码绘制 A、B、C、D 四个选项。**严禁使用文字描述选项**（如“A. 圆形”是错误的，必须画出一个圆的 SVG）。
    3. **格式**：选项内容直接输出 SVG 字符串，不要包裹 markdown 代码块。
- **任务细分**：
  - **资料分析**：
    - **数据展示**：请务必使用标准的 **Markdown 表格** 展示统计数据，确保对齐清晰。
    - **速算技巧**：在 \`analysis\` 块中，必须明确标注使用的技巧（如“特征数字法”、“截位直除法”），并分步展示估算过程。
  - **图形推理**：
    - **SVG规范**：使用 \`\`\`svg ... \`\`\` 包裹题干 SVG。选项直接列出 SVG 代码。
    - **关键描述**：在 <svg> 标签内添加 <title> 描述规律。
- **风格**：简洁、犀利、直击考点。
`,
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].SHEN_LUN]: `
${BASE_INSTRUCTION}
【当前模式：申论 (Essay Writing)】
- **角色**：政策分析师、申论阅卷组长。
- **任务**：
  - **理论引用**：熟练引用官方表述。
  - **文章润色**：将用户的大白话修改为规范的机关公文用语。
  - **提纲构建**：针对社会话题提供标准结构。
  - **解析**：将“参考范文”或“提纲”放入 \`analysis\` 块中，让用户先自己构思。
- **风格**：严谨、大气、政治站位高。
`,
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].MIAN_SHI]: `
${BASE_INSTRUCTION}
【当前模式：面试 (Interview)】
- **角色**：资深面试考官。
- **任务**：
  - **模拟题**：直接给出一道结构化面试题。
  - **高情商回答**：将“答题思路”和“参考话术”放入 \`analysis\` 块中，模拟真实的面试等待思考时间。
  - **追问**：在用户回答后，进行压力测试。
- **风格**：阳光自信，体现政府思维。
`
};
const MODE_LABELS = {
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].XING_CE]: '行测专家',
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].SHEN_LUN]: '申论导师',
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].MIAN_SHI]: '面试考官'
};
const MODE_DESCRIPTIONS = {
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].XING_CE]: '精通历年真题库。擅长逻辑推理、资料分析速算。',
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].SHEN_LUN]: '精通政策理论。擅长公文写作润色与大作文批改。',
    [__TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].MIAN_SHI]: '精通各类面试题型。提供结构化答题思路与模拟。'
};
}),
"[project]/app/api/gemini/quiz/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "POST",
    ()=>POST
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$1$2e$4_react$2d$dom$40$19$2e$2$2e$3_react$40$19$2e$2$2e$3_$5f$react$40$19$2e$2$2e$3$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.1.4_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$google$2b$genai$40$1$2e$38$2e$0$2f$node_modules$2f40$google$2f$genai$2f$dist$2f$node$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/@google+genai@1.38.0/node_modules/@google/genai/dist/node/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/types.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$constants$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/constants.ts [app-route] (ecmascript)");
;
;
;
;
const apiKey = process.env.GEMINI_API_KEY;
if (!apiKey) {
    console.error('GEMINI_API_KEY not found in environment variables');
}
async function POST(request) {
    try {
        if (!apiKey) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$1$2e$4_react$2d$dom$40$19$2e$2$2e$3_react$40$19$2e$2$2e$3_$5f$react$40$19$2e$2$2e$3$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'API Key not configured'
            }, {
                status: 500
            });
        }
        const { mode, topic, count = 5 } = await request.json();
        const ai = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$google$2b$genai$40$1$2e$38$2e$0$2f$node_modules$2f40$google$2f$genai$2f$dist$2f$node$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GoogleGenAI"]({
            apiKey
        });
        const modelName = __TURBOPACK__imported__module__$5b$project$5d2f$constants$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["MODEL_FLASH"];
        let prompt = '';
        if (mode === __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].SHEN_LUN) {
            prompt = `
        请生成 1 道【申论 (Essay Writing)】模拟题。
        主题：${topic || '社会热点'}。

        要求：
        1. 返回纯 JSON 数组格式，只包含 1 个对象。
        2. JSON 字段包含：id, material (给定资料 300字+), question, answer (参考范文), analysis (解析), options: null。
      `;
        } else {
            const isGraphicReasoning = topic?.includes('图形推理');
            prompt = `
        请生成 ${count} 道 ${mode === __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ExamMode"].MIAN_SHI ? '面试' : '行测'} 题目。
        主题：${topic || '随机'}。

        要求：
        1. 返回纯 JSON 数组。
        2. 包含字段：id, question, options (数组), answer, analysis。
        ${isGraphicReasoning ? `
        3. **图形推理强制要求**：
           - **题干**：描述规律后，必须用 \`\`\`svg ... \`\`\` 包裹 SVG 代码。
           - **选项**：\`options\` 数组中的每一项**必须是 SVG 代码字符串**。
           - **选项格式**：例如 ["A. <svg>...</svg>", "B. <svg>...</svg>", "C. <svg>...</svg>", "D. <svg>...</svg>"]。
           - **严禁**使用文字描述（如"A. 一个黑点"）作为选项，必须画出来。
           - 保持 SVG 简洁，viewBox 建议 "0 0 100 100"。
        ` : ''}
      `;
        }
        const response = await ai.models.generateContent({
            model: modelName,
            contents: {
                parts: [
                    {
                        text: prompt
                    }
                ]
            },
            config: {
                responseMimeType: 'application/json'
            }
        });
        const jsonText = response.text || '[]';
        const cleanJson = jsonText.replace(/^```json\s*/, '').replace(/^```\s*/, '').replace(/```$/, '').trim();
        const quizData = JSON.parse(cleanJson);
        const processedData = quizData.map((q, index)=>({
                ...q,
                id: q.id || `quiz-${Date.now()}-${index}`
            }));
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$1$2e$4_react$2d$dom$40$19$2e$2$2e$3_react$40$19$2e$2$2e$3_$5f$react$40$19$2e$2$2e$3$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            quizData: processedData,
            success: true
        });
    } catch (error) {
        console.error('Quiz generation error:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$1$2e$4_react$2d$dom$40$19$2e$2$2e$3_react$40$19$2e$2$2e$3_$5f$react$40$19$2e$2$2e$3$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: error.message || '无法生成题目，请稍后再试。'
        }, {
            status: 500
        });
    }
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__737e4c5f._.js.map